<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-behaviors/paper-button-behavior.html">
<link rel="import" href="../../bower_components/paper-behaviors/paper-checked-element-behavior.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">


<dom-module id="survey-app">
    <template>
        <style>
            :host {
                display: block;
                --app-primary-color: #4285f4;
                --app-secondary-color: black;
            }
            
            app-header {
                background-color: var(--app-primary-color);
                color: #fff;
            }
            
            app-header paper-icon-button {
                --paper-icon-button-ink-color: white;
            }
            
            .card {
                box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
                padding: 16px;
                margin: 24px;
                border-radius: 5px;
                background-color: #fff;
                color: #757575;
            }
        </style>

        <app-header effects="parallax-background">
            <app-toolbar>
                <div title>HCI-Umfrage App</div>
            </app-toolbar>
        </app-header>
        <div id="survey">
        </div>
        <paper-radio-group>
            <paper-radio-button name="yes">yes</paper-radio-button>
            <paper-radio-button name="no">no</paper-radio-button>
        </paper-radio-group>
    </template>

    <script>
        Polymer({

            is: 'survey-app',

            properties: {
                prop1: {
                    type: String
                    , value: 'survey-app'
                }
            }
            , ready: function () {
                foo();
            }

        });

        var questions = [
            {
                "question": "What do you want for christmas?"
                , "mode": "check"
                , "answers": ["Nintendo", "iPony", "You", "A tiny little Shotgun"]
            }

            
            , {
                "question": "What do you want for birthday?"
                , "mode": "check"
                , "answers": ["Nintendo", "iPony", "You", "A tiny little Shotgun"]
            }

            
            , {
                "question": "BigMac??"
                , "mode": "radio"
                , "answers": ["yes", "no"]
            },

        ];
        console.log(questions);

        function foo() {
            questions.forEach(buildQuestion);
            /*
                        var survey = document.getElementById('survey');
                        var card = document.createElement('div');
                        card.className = "card style-scope survey-app";
                        survey.appendChild(card);

                        var question = document.createElement('div');
                        question.className = 'question';
                        question.innerHTML = "Frage:" + questions[0].question;
                        console.log(question);
                        card.appendChild(question);

                        var answers = document.createElement('div');
                        answers.className = "answers";
                        questions[0].answers.forEach(buildCheck);

                        card.appendChild(answers);
                        //console.log(answers);
            */
            function buildQuestion(item, index) {
                var survey = document.getElementById('survey');
                var card = document.createElement('div');
                card.className = "card style-scope survey-app";
                survey.appendChild(card);

                var question = document.createElement('div');
                question.className = 'question';
                question.innerHTML = "Frage: " + questions[index].question;
                card.appendChild(question);

                var answers = document.createElement('div');
                answers.className = "answers";

                if (questions[index].mode =="check") {
                    questions[index].answers.forEach(buildCheck);
                } else {
                    var paperRadioGroup = document.createElement('paper-radio-group');
                    paperRadioGroup.className = "style-scope survey-ap";
                    questions[index].answers.forEach(buildRadio)
                }
                card.appendChild(answers);

                function buildCheck(item, index) {
                    var paperCheckbox = document.createElement('paper-checkbox');
                    var br = document.createElement('br');
                    paperCheckbox.setAttribute("name", item);
                    paperCheckbox.setAttribute("value", item);
                    paperCheckbox.children[1].innerHTML = item;
                    paperCheckbox.children[1].removeAttribute("hidden");

                    answers.appendChild(paperCheckbox);
                    answers.appendChild(br);
                }

                function buildRadio(item, index) {
                    var paperRadioButton = document.createElement('paper-radio-button');
                    var br = document.createElement('br');

                    paperRadioButton.setAttribute("name", item);
                    paperRadioButton.setAttribute("tabindex", -1);
                    paperRadioButton.setAttribute("toggles","");
                    
                    paperRadioButton.className = "style-scope survey-app";

                    paperRadioButton.children[1].innerHTML = item;
                    paperRadioButton.children[1].removeAttribute("hidden");

                    paperRadioGroup.appendChild(paperRadioButton);
                    paperRadioGroup.appendChild(br);
                    answers.appendChild(paperRadioGroup);
                }
            }
        }
    </script>
</dom-module>